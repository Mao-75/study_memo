# 検索
SELECT・・・目的とする列名

*(アスタリスク)は全ての列と言う意味

ある条件を満たす行を探す ⇒ その行の内容を取得する。


FROM・・・検索したいテーブル名を指定。

```
[例]
SELECT 出金額
  FROM 家計簿
```

```
[例] * を使用した場合
SELECT *
  FROM 家計簿
```

# SELECT文にだけ可能な修飾

### DISTINCT(ディスティンクト)

→検索結果から重複行を除外する。
```
SELECT DISTINCT 列名 ...
FROM テーブル名
```

### OREDER BY

→検索結果の順序を並び替える。

昇順はASC、降順はDESC。

並び順を省略するとASCで並び替えられる。
```
SELECT 列名 FROM テーブル名
ORDER BY 列名 並び順
```
```
[例] 複数の列で並び替え
//入金額を降順で並べ替え、入金額が等しい行は出金額の降順で並び替える
SELECT * FROM 家計簿
ORDER BY 入金額 DESC, 出金額 DESC
```

### OFFSET - FETCH

→検索結果から件数を限定して取得する。

検索結果の全行ではなく、並べ替えた結果の一部だけを取得したい場合に使用される。
```
SELECT 列名 FROM テーブル名
ORDER BY 列名
OFFSET 先頭から除外する行数 ROWS
FETCH NEXT 取得行数 ROWS ONLY
```
```
[例] 出金額の高い順に３件を取得
SELECT 費目, 出金額 FROM 家計簿
ORDER BY 出金額 DESC
OFFSET 0 ROWS
FETCH NEXT 3 ROWS ONLY
```
```
[例] ３番目に高い出金額だけを取得
SELECT 費目, 出金額 FROM 家計簿
ORDER BY 出金額 DESC
OFFSET 2 ROWS
FETCH NEXT 1 ROWS ONLY
```

# 集合演算子

→SELECT命令によって抽出したデータの集合の結果同士を足し合わせたり、共通部分を探すなどを行なってくれる演算子。

## 集合演算子を使用できる条件

→選択列リストの列数とそれぞれのデータ型が一致していること。

### UNION(ユニオン)

→和集合。

検索結果に他の検索結果を足し合わせたもの。

### 和集合の結果に重複行があった場合の動作

UNION単独・・・重複行を1行にまとめる。

UNION ALL ・・・重複行をまとめずに全てそのまま返す。
```
SELECT 1文
UNION (ALL)
SELECT 2文
```
```
[例] 家計簿テーブルと家計簿アーカイブテーブルの和集合
SELECT 費目, 入金額, 出金額 FROM 家計簿
UNION
SELECT 費目, 入金額, 出金額 FROM 家計簿アーカイブ
/* 入金額で並び替、次に出金額で並び替え、最後に費目で並び替えをする。
   入金額と出金額が同じ行は、費目の値に基づいて順序付けられる。*/
ORDER BY 2, 3, 1
```

### EXCEPT(エクセプト) / MINUS(マイナス)

→差集合。

最初の検索結果から次の検索結果と重複する部分を取り除いたもの。
```
SELECT 1文
EXCEPT (ALL)
SELECT 2文
```
```
[例] 家計簿アーカイブデーブルには存在せず、家計簿テーブルには存在する費目を取得
SELECT 費目 FROM 家計簿
EXCEPT
SELECT 費目 FROM 家計簿アーカイブ
```

### INTERSECT(インターセクト)

→積集合。

検索結果と他の検索結果で重複するもの。
```
SELECT 1文
INTERSECT (ALL)
SELECT 2文
```
```
[例] 家計簿テーブルと家計簿アーカイブテーブルの積集合
SELECT 費目 FROM 家計簿
INTERSECT  //MySQLでは非対応
SELECT 費目 FROM 家計簿アーカイブ
```

## 選択列リストの指定と結果

→列名: 列の内容がそのまま出力される。

計算式: 計算式の評価結果が出力される。また計算式が結果表の列名になる。

固定値: 固定値(リテラル)がそのまま出力される。また固定値が結果表の列名になる。
```
[例]
SELECT 出金額,       -- 列名での指定
       出金額 + 100, -- 計算式での指定
       'SQL'        -- 固定値での指定
FROM 家計簿
```
| 出金額 | 出金額 + 100 | ‘SQL’ |
| --- | --- | --- |
| 380 | 480 | SQL |
| 0 | 100 | SQL |
| 2800 | 2900 | SQL |
